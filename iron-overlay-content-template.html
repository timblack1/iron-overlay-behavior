<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="iron-overlay-manager.html">

<script>
  /** @demo demo/template.html */

  Polymer({
    is: 'overlay-content',
    extends: 'template',
    behaviors: [Polymer.Templatizer],
    properties: {
      contentParent: {
        type: Node,
        observer: '_contentParentChanged'
      }
    },
    created: function() {
      this._physicalItems = [];
    },
    attached: function() {
      if (this.contentParent) {
        this._contentParentChanged(this.contentParent);
      }
    },

    _contentParentChanged: function() {
      if (!this.isAttached || this.__instance) {
        return;
      }
      this.templatize(this);
      this.__instance = this.stamp();
      this._physicalItems = this.__instance.root.querySelectorAll('*');
      Polymer.dom(this.contentParent).appendChild(this.__instance.root);
    },
    /**
     * Implements extension point from Templatizer.
     * Forward values to overlay instance.
     */
    _forwardParentProp: function(prop, value) {
      for (var i = 0; i < this._physicalItems.length; i++) {
        var inst = this._physicalItems[i]._templateInstance;
        // Might be undefined (e.g. for template elements)
        if (inst) {
          inst[prop] = value;
        }
      }
    },
  });
</script>
